
run:
  name: cifar100_deits_calattn
  out_dir: outputs
  seed: 0

data:
  dataset: cifar100
  data_dir: ./data
  img_size: 224
  batch_size: 128
  num_workers: 8
  val_split: 0.05

model:
  backbone: deit_small_patch16_224
  num_classes: 100
  pretrained: true

method:
  name: calattn   # choices: ce, ce_ls, brier, ce_brier, mmce, focal_flsd53, dual_focal, relaxed_softmax, calattn
  lambda_brier: 0.1
  label_smoothing: 0.1
  calattn_hidden: 128
  calattn_on: cls          # cls | patch_mean | concat
  relaxed_hidden: 128

optim:
  optimizer: sgd            # sgd | adamw
  lr: 0.1
  weight_decay: 5e-4
  momentum: 0.9

sched:
  type: step
  epochs: 350
  milestones: [150, 250]
  gamma: 0.1

eval:
  do_ts: true
  ts_bins: 15
  ts_grid: [0.1, 10.0, 0.1]   # start, end, step
  save_logits: true
